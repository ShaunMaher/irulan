module.exports = sysinfo;
module.exports.get = get;
module.app = {};

var fs = require("fs");
var path = require("path");

function sysinfo(_app, router) {
  app = module.app = _app;

  //  WikiPage and markdownRenderer providers
  //app.ClientScripts['single page application'].push({
  //  name: 'components.wikipages.js',
  //  offline_path: app.Settings['node modules directory'] + '/irulanwiki/components.wikipages.js'
  //})
  app.ClientScripts['single page application'].push({
    name: 'irulansysinfo.js',
    offline_path: app.Settings['node modules directory'] + '/irulansysinfo/irulan_client_app.js'
  })

  // Inject handlers for RESTful requests for page content
  router.get(/^\/pages\/sysinfo\//, function (req, res, next) {
    sysinfo.get(req, res, next);
  })
  router.get(/^\/pages\/sysinfo:/, function (req, res, next) {
    sysinfo.get(req, res, next);
  })
  router.get(/^\/sysinfo\//, function (req, res, next) {
    app.IndexPageApplication.IndexPage(req, res, next);
  });

}

function get(req, res, next) {
  var app = module.app;

  context.sysinfoEntry.content = data;
  context.res.send(JSON.stringify(context.sysinfo));
}
